-----------------------------------------------------------------------------
-- |
-- Module      :  RequirementModel.Parsers.XmlRequirementParser
-- Copyright   :  (c) Rodrigo Bonifacio 2008, 2009
-- License     :  LGPL
--
-- Maintainer  :  rba2@cin.ufpe.br
-- Stability   :  provisional
-- Portability :  portable
--
-- A XML parser for our requirement model.
--
-----------------------------------------------------------------------------
module RequirementModel.Parsers.XmlRequirementParser
where 

import RequirementModel.Types

import Text.XML.HXT.Arrow
import System.Environment

instance XmlPickler RequirementModel where
	xpickle = xpRequirementModel

instance XmlPickler Requirement where 
	xpickle = xpRequirement

xpRequirementModel :: PU RequirementModel
xpRequirementModel = 
	xpElem "requirementModel" $
	xpWrap ( RM, \ (RM r) -> (r) ) $
        (xpList xpRequirement)		 
			 
xpRequirement :: PU Requirement
xpRequirement = 	
	xpElem   "requirement" $
	xpWrap   ( uncurry2 Requirement, \ (Requirement i n d) -> (i, n, d) ) $
	xpTriple ( xpElem "id" xpText ) 
                 ( xpElem "name" xpText )
                 ( xpElem "description" xpText) 

